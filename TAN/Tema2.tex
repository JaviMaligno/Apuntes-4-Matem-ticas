\documentclass[TAN.tex]{subfiles}
\begin{document}
\chapter{Distribución de los números primos\\Métodos elemntales}

\section{Funciones de Chebyshev}
\begin{nota}
\[ π(x)=\sum_{p≤x} 1, \quad θ(x) = \sum_{p≤x} \log p, \quad ψ(x)=\sum_{p^k≤x} \log p \]
\end{nota}
Observar que $ψ(x)$ es el logaritmo del mínimo común múltiplo de los $n$ primeros números naturales.

\begin{prop} Se tienen las relaciones
\end{prop}

\section{Teoremas de Chebyshev}
\begin{teorema}
Para $x ≥ 1$ se tiene:
\[ \prod_{p≤x} p ≤ 4^{x-1} \]
\end{teorema}
\begin{dem}
\url{https://amakelov.github.io/2015/12/23/A-neat-bound-on-the-primorial-due-to-Erdos.html}
Podemos considerar que $x$ es natural. Vamos a distinguir los casos $x$ par e impar. Supongamos primero el caso impar $x=2n+1$. Lo demostraremos por inducción. Después de comprobar unos casos base, supongamos que tengamos que la hipótesis para $2n-1$. Como $n+1≤2n$:
\[ \prod_{p≤2n+1} p = \prod_{p≤n+1} p \prod_{n+1<p≤2n+1} p ≤ 4^n \prod_{n+1<p≤2n+1} p ≤ 4^n \cdot \binom{2n+1}{n+1}≤ 4^n\cdot 2^{2n}=4^{2n}=4^x \]
Como $\prod_{n+1<p≤2n+1} p $

Para $x=2n$:
\[ \prod_{p≤2n} p = \prod_{p≤n} p \prod {n<p≤2n}p ≤ 4^{n-1}\]
\end{dem}

\begin{teorema}[Legendre]
Si $n$ es un número natural y $p$ un primo, el exponente $ν_p(n!)$ de $p$ en $n!$ es igual a
\[ ν_p(n!) = \lfloor \frac{n}{p}\rfloor + \lfloor \frac{n}{p^2}\rfloor + \lfloor \frac{n}{p^3}\rfloor + \dots \]
\end{teorema}

\begin{coro}
Hay $\min(v_2(n!),v_5(5!))$ ceros al final de la representación decimal de $n!$.
\end{coro}

\begin{lemma}
Sea $p$ un primo. Si $p^a$ es la mayor potencia de $p$ que divide a $\binom{n}{k}$, entonces $p^a ≤ n$.
\end{lemma}
\begin{dem}
Podemos extender $v_p(a/b) = v_p(a)-v_p(b)$. Entonces:
\[ v_p\binom{n}{k} = v_p(n!) - v_p(k!) - v_p((n-k)!) = \sum_{a=1} \left(\lfloor \frac{n}{p^a} \rfloor - \lfloor \frac{k}{p^a}\rfloor - \lfloor \frac{n-k}{p^a} \rfloor\right) \]
Como se tiene que: $\lfloor x+y \rfloor -\lfloor x\rfloor - \lfloor y \rfloor ≤ 1$. Entonces $ν_p\binom{n}{k}$ es un entero no negativo. Además, de que $n ≥ k$, luego los términos son ceros una vez que $p^a>n$. Sea $b$ el entero que cumple que $p^b ≤ n < p^{b+1}$, entonces:
\[ a ≤ v_p\binom{n}{k} ≤ b \]
Entonces $p^a≤p^b≤n$.
\end{dem}

\begin{coro}
Cada coeficiente binomial $\binom{n}{k} ≤ n^{π(n)}$.
\end{coro}
\begin{dem}
\[ \binom{n}{k} = \prod_{p≤n} p^{v_p\binom{n}{k}} ≤ \prod_{p≤n} n = n^{π(n)} \]
\end{dem}

No sé a cuento de qué pero voy a copiar lo que viene en la pizarra.

Si $x\geq 1$ entonces $\sum_{p\leq x} \log p \leq (x-1) \log 4$. Si definimos $a_n$ como la indicatriz de los primos, entonces 
$$\sum_{p\leq x} \log p = \sum_{n\leq x}a_n \log n = \pi(x)\log(x)-\int_1^x \pi(t)\frac{dt}{t}$$
$$\pi(x)\log(x) \leq \int_1^x \pi(t)\frac{dt}{t} + (x-1)\log 4
\leq \int_1^x t\frac{dt}{t} + (x-1)\log4 = (x-1)(\log4 +1)$$
$$ \pi(x)\leq (\log 4 +1) \frac{x-1}{\log x}\leq (1+\log 4)\frac{x}{\log x}$$
Si $x\geq 3$, $n=\lfloor x \rfloor$, $n\leq x < n+1$. Entonces
\begin{gather*}
2^x < 2^{n+1} = \sum_{k=0}^{n+1}\binom{n+1}{k} = 2+ \sum_{k=1}^n \binom{n+1}{k} \leq 2 + \sum_{k=1}^n 2n^{\pi(n)} \leq\\
\leq 2+2n^{\pi(n)+1} \leq 4n^{\pi(n)+1}\leq 4x^{\pi(x)+1}
\end{gather*}
\begin{gather*}
x \log 2 \leq 2\log 2 + (\pi(x)+1)\log x\\
 \pi(x) \geq \log 2 \frac{x}{\log x} -1 -\frac{\log 4}{\log x} = \frac{1}{2}\frac{x}{\log x} +  (\log 2 - \frac{1}{2})\frac{x}{\log x} -1 - \frac{\log4}{\log x} \geq \frac{x}{2\log{x}}
	\end{gather*}

\begin{coro}
Existen constantes $0<c<C<+∞$ tal que
\[ c n \log n < p_n < C n \log n \]
\end{coro}
\begin{dem}
Vamos a ver que $p_n \sim n \log n$. Si aplicamos la desigualdad anterior $x=p_n$ entonces:
$$
A\frac{p_n}{\log p_n} \leq \pi(p_n) = n \Rightarrow p_n \leq \frac{1}{A}n\log p_n 
$$
Tomando logaritmos es fácil ver que para algún $\delta >0$
$$
\log n \geq \log p_n - \log \log p_n - \log A \geq (1-\delta) \log p_n$$ 
$$
p_n \leq \frac{1}{A}\frac{1}{1-\delta}n \log n$$
Por otra parte, $n = \pi(p_n) \leq B \dfrac{p_n}{\log p_n}$.
$$p_n \geq \frac{1}{B}n\log p_n \geq \frac{1}{B}n \log n$$
\end{dem}

\begin{dem}[Demostración de algún teorema]
Sabemos que $n! = \prod_{p\leq n} p^{\nu_p(n!)}$. Si $x\geq 1$ y $\lfloor x \rfloor = n$
\begin{gather*}
\log n! = \sum_{k\leq x} \log k = \sum_{k \leq x} 1 \cdot \log k = \lfloor x \rfloor\log x - \int_1^x \lfloor t \rfloor \frac{dt}{t} = \\ =
x\log x + O(\log x) - (x-1) + \int_1^x\frac{\{t\}}{t}dt =  x\log x - x  + O(\log x)
\end{gather*}
Ya que 
$$
 \int_1^x\frac{\{t\}}{t}dt  \leq  \int_1^x\frac{1}{t} = \log xdt 
$$
\end{dem}

\section{Teoremas de Mertens}
\begin{teorema}[Primer teorema de Mertens]
\[ \sum_{p≤x} \frac{\log p}{p} = \log x + \mathcal{O}(1) \]
\end{teorema}
Demostración en Tenenbaum p.14.

\begin{teorema}[Mertens]
Existe una constante $C$ tal que
\[ \sum_{p≤x} \frac{1}{p} = \log \log x + C + \mathcal{O}\left(\frac{1}{\log x}\right) \]
\end{teorema}
Demostración en Tenenbaum p.152.

\begin{teorema}[Segundo teorema de Mertens]
\[ \prod_{p≤x} \left(1-\frac{1}{p}\right)^{-1} = e^γ\log x + \mathcal{O}(1) \]
donde $γ$ denota la constante de Euler.
\end{teorema}
Ver Tenenbaum p.17 y Mendes France p.21.

Los teoremas anteriores tienen forma más precisa:
\[ \sum_{p≤x} \frac{\log p}{p} = \log x + E + \mathcal{O}(e^{-a\sqrt{\log x}}) \]
con
\[ E = -γ-\log_{p} \frac{\log p}{p^2-p} = -γ-\sum_{m=2}^{∞} μ(m) \frac{ζ'(m)}{ζ(m)} = -1.332582275733221... \]
sus dígitos forman la sucesión \href{https://oeis.org/A083343}{A083343} en OEIS.
\[ \sum_{p≤x} \frac{1}{p} = \log \log x + M + \mathcal{O}(e^{-a\sqrt{\log x}}) \]
\[ M = \sum_{p} \left(\log \left(1-\frac{1}{p}\right)+\frac{1}{p}\right) = γ + \sum_{m=2}^{∞} \frac{\log ζ(m)}{m} = 0.261497212847643... \]
sus dígitos forman la sucesión \href{https://oeis.org/A077761}{A077761} en OEIS. 

\section{Equivalentes al teorema de los números primos}
Se denomina así al teorema que afirma
\[ \lim_{x\to+∞} \frac{π(x)\log x}{x} = 1 \]
que fue demostrado independientemente por Hadamard y de la Vallée-Poussin.

El siguiente teorema permite simplifcar la prueba del teorema de los números primos gracias a que da muchas formulaciones equivalentes.

\begin{teorema}[Chebyshev]
Existen constantes $A$ y $B$ tales que para todo $α \in (0,1)$
\[ αAx ≤ απ(x)\log x ≤ θ(x) ≤ ψ(x) ≤ π(x)\log x ≤ Bx \]
para todo $x ≥ x_0(α)$.
\end{teorema}

\begin{teorema}[Chebyshev]
\[ \liminf_{x\to∞} \frac{θ(x)}{x} = \liminf_{x\to∞} \frac{ψ(x)}{x} = \liminf_{x\to∞} \frac{π(x)\log x}{x} ≥ \log 2 \]
y
\[ \limsup_{x\to∞} \frac{θ(x)}{x} = \limsup_{x\to∞} \frac{ψ(x)}{x} = \limsup_{x\to∞} \frac{π(x)\log x}{x} ≤ \log 4 \]
\end{teorema}
Demostración en Nathanson p.271.

\section{Método de la criba}
El origen del método es la criba de Eratóstenes. La criba de Eratóstenes conduce a la siguiente fórmula.

\begin{teorema}[Fórmula de Legendre]
Para todo $x > 1$ se tiene
\[ π(x) - π(\sqrt{x}) + 1 = \sum_{n|P_x}μ(n)\lfloor\frac{x}{n}\rfloor \]
donde $P_x$ denota el producto de los números primos menores o iguales a $x$.
\end{teorema}

\begin{dem}
Sea $X=\{n≤x\}$. Para $p≤\sqrt{x}$ primo, definimos $A_p=\{n \in X, p|n\}$.
Tenemos que:
Para un $n \in X$ compuesto, como $n≤x$ entonce consideramos el menor de los primos $p$ tal que $p|n$. Debe existir $m$ con $p\cdot m = n$. Como los primos que hay en $m$ son mayores o iguales que $p$: $p^2 ≤ p\cdot m = n ≤ x$, luego $p≤\sqrt{x}$. Entonces:
\[ X \setminus \bigcup_{p≤\sqrt{x}} = \{1 \} \cup \{p : \sqrt{x} < p ≤ x\} \]
Luego
\[ \text{card}\left(X \setminus \bigcup_{p≤\sqrt{x}} A_p\right) = π(x) - π(\sqrt{x}) + 1 \]
Aplicamos el método de inclusión-exclusion y observando que:
\[ \text{card}\left(\bigcap_{j=1}^r A_{p_j}\right) =\text{card}(\{N≤x : n|N\}) = \lfloor \frac{x}{n} \rfloor\]
donde $n = p_{j_1}\cdots p_{j_r}$, la demostración sigue sin dificultad.
\qed
\end{dem}

Esta fórmula parece poco útil a primera vista. El gran mérito de Brun es dar con técnicas que permiten hacerla útil

El problema con esta fórmula es que la diferencia $π(x)-π(\sqrt{x})$ se da en términos de una suma con demasiados sumandos, aun cuando estos sumandos se obtengan con error pequeñ al multiplicar por el número de términos se obtienen errores randes. El mérito de Brun es haber ideado un método de salvar esta dificultad.

Veremos como funciona la idea de Brun, estudiando su aplicación a la cuenta de los primos gemelos. En primer lugar introducimos la función de cuenta de estos números
\[ π_2(x) = \text{card}\{p : p \text{ y }p+2\text{ son primos y }p≤x\} \]
La idea básica del método de Brun es una modificación del método de exclusión-inclusión: si en un conjunto finito $X$ se tienen subconjuntos $(A_j)_{j=1}^n$ entonces para todo natural $h$, tal que $2≤2h≤n$
\[ \text{card}\left(X \setminus \bigcup_{j=1}^n A_j \right) ≤ \sum_{k=0}^{2h} \sum_{\text{card}(J)=k} (-1)^k \text{card}\left(\bigcap_{j\in J} A_j \right)\]

Con la ayuda de este principio se consigue probar.

Este apartado puede estudiarse en Cilleruelo \& Córdoba.

\begin{teorema}
Existe una constante $C$ tal que para $x ≥ 2$
\[ π_2(x) ≤ C \frac{x}{(\log x)^2} (\log \log x)^2 \]
\end{teorema}
Para ello cribamos el conjunto $A_x = \{(2n-1)(2n+1) : 1 ≤ n ≤ (1+x)/2\}$
por los primos impares menores que un cierto $a ≤ \sqrt{x+2}$.

\begin{coro}
Si $P_2$ es el conjunto finito o infinito de los números primos $p$ tales que $p+2$ es primo se tiene
\[ \sum_{p\in P_2} \frac{1}{p} < +∞ \]
\end{coro}

\section{El número de divisores primos de un entero}
Nos proponemos estudiar el comportamiento de la función $ω(n)$.
\begin{teorema}
Para $x ≥ 2$
\[ \sum_{n≤x} ω(n) = x\log \log x + Cx + \mathcal{O}\left(\frac{x}{\log x}\right) \]
\end{teorema}
\begin{dem}
\begin{align*}
	\sum_{n≤x} ω(n) & = \sum_{n≤x}\sum_{p|n≤x} 1 = \sum_{p≤x} \lfloor\frac{x}{p}\rfloor = \sum_{p≤x} \frac{x}{p}- \sum_{p≤x} \left\{\frac{x}{p}\right\} \\
	& = x \left(\log \log x + C + \mathcal{O}\left(\frac{1}{\log x}\right)\right) + \mathcal{O}\left(\frac{x}{\log x}\right)
\end{align*} 
\end{dem}
\begin{teorema}
Para $x ≥ 2$
\[ \sum_{n≤x} ω(n)^2 = x(\log \log x)^2 + \mathcal{O}(x \log \log x) \]
\end{teorema}
\begin{dem}
Sea $f_p(n) = 1$ si $p|n$ y $f_p(n)=0$ en caso contrario. Entonces:
\begin{align*}
	\sum_{n≤x} ω(n)^2 & = \sum_{n≤x}\left(\sum_{p|n≤x} 1\right)^2 = \sum_{n≤x}\left(\sum_{p≤x} f_p(n)\right)^2 = \sum_{n≤x} \left(\sum_{p≤x} f_p(n)^2\right) + 2 \sum_{n≤x} \sum_{p<q≤x} f_p(n)f_q(n)\\
	& = \sum_{n≤x} ω(n) + 2 \sum_{p<q≤x} \sum_{n≤x} f_p(n)f_q(n)
\end{align*} 
Aquí dejó la demostración. Al día siguiente de clase, se continuó la demostración de una forma totalmente distinta:
\begin{align*}
	\sum_{n≤x} (ω(n)-\log\log x)^2 & = \sum_{n≤x} ω(n)^2 - 2\log\log x \sum_{n≤x}ω(n) + (\log\log x)^2 \sum_{n≤x} 1\\
	& = x(\log \log x)^2+ \mathcal{O}(x\log \log x) - 2\log\log x(x\log \log x + Cx + \mathcal{O}(x/\log x))\\
	& + \lfloor x \rfloor (\log \log x)^2 + (x-\{x\})(\log \log x)^2 =\\
	& = \mathcal{O}(x\log \log x) - 2Cx \log \log x + \mathcal{O}(x\frac{\log \log x}{\log x}) + \mathcal{O}((\log \log x)^2)
	= \mathcal{O}(x\log \log x)
\end{align*}
\qed
\end{dem}
\begin{coro}
Consideramos el conjunto $A(x)=\{n ≤ x : |ω(n)-\log \log x| > f(x)\sqrt{\log \log x}\}$ para una $f≥0$ creciente con $\lim_{x\to ∞} f(x)=∞$. Veamos que $\lim_{x\to ∞}\text{card}(A(x))/x = 0$. 
\end{coro}
\begin{dem}
Se tiene que:
\[ \text{card}(A(x))f(x)\log \log  ≤ \sum_{n≤x} (ω(n) - \log \log x)^2 ≤ Cx \log \log x \]
Entoncs:
\[ \frac{\text{card}(A(x))}{x} ≤ C \frac{x \log \log x}{f(x) \log \log x} = C \frac{x}{f(x)} \to 0\]
\qed
\end{dem}
El orden normal de $ω(n)$ es $\log \log n$ como se establece en el siguiente teorema.
\begin{teorema}[Hardy-Ramanujan]
Para cada $δ > 0$, el numero de enteros $n < x$ tales que
\[ |ω(n) - \log \log n| ≥ (\log \log x)^{1/2+δ} \]
es $ο(x)$.
\end{teorema}
La prueba puede verse en Nathanson p.238-287. También es buena la exposición de M. Kac p.71-74.

La misma afirmación vale si sustituimos $ω(n)$ por $Ω(n)$. El orden normal de $\log d(n)$ como consecuencia es $\log 2 \log \log n$.

\end{document}
