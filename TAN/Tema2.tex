\documentclass[TAN.tex]{subfiles}
\begin{document}
\chapter{Distribución de los números primos\\Métodos elemntales}

\section{Funciones de Chebyshev}
\begin{nota}
\[ π(x)=\sum_{p≤x} 1, \quad θ(x) = \sum_{p≤x} \log p, \quad ψ(x)=\sum_{p^k≤x} \log p \]
\end{nota}
Observar que $ψ(x)$ es el logaritmo del mínimo común múltiplo de los $n$ primeros naturales.

\begin{prop} Se tienen las relaciones
$$
\theta(x)=\log \prod_{p\leq x} p \qquad\psi(x)=\sum_{n=1}^\infty \theta(x^{1/n})$$
\end{prop}
\begin{dem}
La primera igualdad es trivial. Para la segunda, tengamos en cuenta que si $p^k \leq x$ entonces $p\leq x^{1/k}$ y recíprocamente. Por tanto, para cada $k$ fijo
$$
\sum_{p^k≤x} \log p = \sum_{p≤x^{1/k}} \log p = \theta(x^{1/n}) \qquad 
 $$
\end{dem}
\begin{defi}
Definimos la función de von Mangoldt como
$$
\Lambda(n)=
\begin{cases}
\log p & \text{si $n=p^k$ para algún primo $p>1$}\\
0 & \text{c.c.}
\end{cases}
$$
\end{defi}
\begin{prop}
La función de von Mangoldt verifica las siguientes propiedades
\begin{itemize}
\item No es multiplicativa ni aditiva.
\item Se tienen las igualdades
\begin{gather*}
\log(n) = \sum_{d\mid n} \Lambda(d) = (\Lambda \ast 1)(n) \qquad \Lambda(n) = \sum_{d\mid n} \mu(n/d)\log d \\
\zeta(s)' = - \sum_{n=1}^\infty \frac{\log n}{n^s} = -\left(\sum_{n=1}^\infty \frac{1}{n^s} \right)\left(\sum_{n=1}^\infty \frac{\Lambda(n)}{n^s} \right) = - \zeta(s)\sum_{n=1}^\infty \frac{\Lambda(n)}{n^s} \\
\frac{\zeta(s)'}{\zeta(s)}= -\sum_{n=1}^\infty \frac{\Lambda(n)}{n^s}
\end{gather*}
\end{itemize}
\end{prop}
\section{Teoremas de Chebyshev}
\begin{teorema}
Para $x ≥ 1$ se tiene:
\[ \prod_{p≤x} p ≤ 4^{x-1} \]
\end{teorema}
\begin{dem}
Si estuviera probado para los naturales, entonces tomando $n=\suelo{x}\leq x < n+1$ tendríamos
$$
 \prod_{p≤x} p =  \prod_{p≤n} p \leq 4^{n-1}\leq 4^{x-1}
 $$
Vamos a probarlo por inducción el resultado para $\N$. Los casos $n=1,2,3,4$ son fácilmente comprobables. Vamos a distinguir los casos $x$ par e impar. Supongamos primero el caso impar $x=2n+1$. Supongamos que tengamos que la hipótesis para $2n$. Como $n+1≤2n$:
\[ \prod_{p≤2n+1} p = \prod_{p≤n+1} p \prod_{n+1<p≤2n+1} p ≤ 4^n \prod_{n+1<p≤2n+1} p \overset{(1)}{≤} 4^n \binom{2n+1}{n+1}\overset{(2)}{≤} 4^n 2^{2n}=4^{2n}=4^{x-1} \]
La desigualdad $(1)$ viene dada puesto que todo primo $n+1<p\leq 2n+1$ está en el numerador de la binomial, pero no en el denominador, por lo que el producto de todos divide al valor de la binomial. Para ver $(2)$ 
$$
2^{2n+1} = \sum_{k=0}^{2n+1}\binom{2n+1}{k} \geq \binom{2n+1}{n}+\binom{2n+1}{n+1} = 2\binom{2n+1}{n+1} 
$$

Para $x=2n$:
\[ \prod_{p≤2n} p = \prod_{p≤n} p \prod_{n<p≤2n}p ≤ 4^{n-1}\binom{2n}{n} \leq 4^{n-1}4^n = 4^{2n-1}= 4^{x-1} \]
\end{dem}

\begin{teorema}[Legendre]
Si $n$ es un número natural y $p$ un primo, el exponente $ν_p(n!)$ de $p$ en $n!$ es igual a
\[ ν_p(n!) = \suelo{ \frac{n}{p}} + \suelo{ \frac{n}{p^2}} + \suelo{ \frac{n}{p^3}} + \dots \]
\end{teorema}
\begin{dem}
En primer lugar, notemos que la suma es finita, pues $\exists k$ tal que $p^k>n$, luego $\forall s \geq k$ $\suelo{n/p^s}=0$. El número de múltiplos de $p^k$ en $\{1,2,\dotsc,n\}$ es $\suelo{n/p^k}$ y cada uno de ellos aporta un factor $p$ a $n!$.
\end{dem}
\begin{coro}
Hay $\min(\nu_2(n!),\nu_5(n!))$ ceros al final de la representación decimal de $n!$.
\end{coro}

\begin{lemma}
Sea $p$ un primo. Si $p^a$ es la mayor potencia de $p$ que divide a $\binom{n}{k}$, entonces $p^a ≤ n$.
\end{lemma}
\begin{dem}
Podemos extender $\nu_p(a/b) = \nu_p(a)-\nu_p(b)$. Entonces:
\[ \nu_p\binom{n}{k} = \nu_p(n!) - \nu_p(k!) - \nu_p((n-k)!) = \sum_{a=1} \left(\suelo{ \frac{n}{p^a} } - \suelo{ \frac{k}{p^a}} - \suelo{ \frac{n-k}{p^a} }\right) \]
Como se tiene que: $0\leq \suelo{ x+y } -\suelo{ x} - \suelo{ y } ≤ 1$. Entonces $ν_p\binom{n}{k}$ es un entero no negativo. Sea $b$ el entero que verifica que $\nu_p\binom{n}{k}\leq b$, $p^b\leq n <p^{b+1}$. Entonces, como $a \leq \nu_p\binom{n}{k}\leq b$, $a\leq b$, $p^a \leq p^b \leq n$.
\end{dem}

\begin{coro}
Cada coeficiente binomial $\binom{n}{k} ≤ n^{π(n)}$.
\end{coro}
\begin{dem}
\[ \binom{n}{k} = \prod_{p≤n} p^{\nu_p\binom{n}{k}} ≤ \prod_{p≤n} n = n^{π(n)} \]
\end{dem}
\begin{teorema}[Chebyshev] Para $x\geq 3$ se tiene
$$
\frac{1}{2}\frac{x}{\log x}\leq \pi(x)\leq (1+\log 4)\frac{x}{\log x}
$$
\end{teorema}
\begin{dem}
Si $x\geq 1$ entonces 
$$\prod_{p\leq x}\leq 4^{x-1} \Rightarrow \sum_{p\leq x} \log p \leq (x-1) \log 4$$
Si definimos $a_n=I_{\mathbb{P}}(n)$ la función indicatriz de los primos, entonces aplicando la Fórmula de Sumación de Abel
$$\sum_{p\leq x} \log p = \sum_{n\leq x}a_n \log n = \pi(x)\log(x)-\int_1^x \pi(t)\frac{dt}{t}$$
$$\pi(x)\log(x) \leq \int_1^x \pi(t)\frac{dt}{t} + (x-1)\log 4
\leq \int_1^x t\frac{dt}{t} + (x-1)\log4 = (x-1)(\log4 +1)$$
$$ \pi(x)\leq (\log 4 +1) \frac{x-1}{\log x}\leq (1+\log 4)\frac{x}{\log x}$$
Si $x\geq 3$, $n=\suelo{ x }$, $n\leq x < n+1$. Entonces
\begin{align*}
2^x &< 2^{n+1} = \sum_{k=0}^{n+1}\binom{n+1}{k} = \binom{n+1}{0}+\binom{n+1}{n+1} + \sum_{k=1}^n \binom{n+1}{k}\\
&= 2 +  \sum_{k=1}^n \left(\binom{n}{k-1}+\binom{n}{k}\right) \leq 2 + \sum_{k=1}^n 2n^{\pi(n)} = 2+2n^{\pi(n)+1} \\
&\leq 4n^{\pi(n)+1}\leq 4x^{\pi(x)+1}
\end{align*}
Deducimos por tanto que $x \log 2\leq \log 4 + (\pi(x)+1)\log x$. Despejando	
\begin{align*}
 \pi(x) \geq \log 2 \frac{x}{\log x} -\frac{\log 4}{\log x}-1 = \frac{1}{2}\frac{x}{\log x} +  \left(\log 2 - \frac{1}{2}\right)\frac{x}{\log x} - \frac{\log4}{\log x}-1 \geq \frac{x}{2\log{x}}
\end{align*}
Para la última desiguadad, comprobamos los casos $3\leq n \leq 8$ (pues $\pi$ es una función aritmética y $\dfrac{x}{2\log{x}}$ es creciente en ese intervalo) y utilizamos que si $x\geq 8$ entonces
$$
 \left(\log 2 - \frac{1}{2}\right)\frac{x}{\log x} - \frac{\log4}{\log x}-1 > 0
$$
\end{dem}
\begin{coro}
Existen constantes $0<c<C<+∞$ tal que
\[{c}\,{n} \log n < p_n < C n \log n \]
\end{coro}
\begin{dem}
Vamos a ver que $p_n \sim n \log n$. Si aplicamos la desigualdad anterior $x=p_n$ entonces:
$$
A\frac{p_n}{\log p_n} \leq \pi(p_n) = n \qquad  p_n \leq \frac{1}{A}n\log p_n \qquad \log n \geq \log p_n - \log \log p_n - \log A
$$
Dado que
$$
\lim_{x\to\infty}\frac{\log x-\log\log x-\log A}{\log x}= 1
$$
Podemos tomar $\delta >0$ tal que
$$
(1-\delta)\log p_n \leq \log n \qquad p_n \leq \frac{1}{A}n\log p_n\leq \frac{1}{A}\frac{1}{1-\delta}n \log n\equiv C n \log n$$
Por otra parte, aplicando la otra desigualdad a $x=\pi_n$, entonces
$$n=\pi(p_n) \leq B \dfrac{p_n}{\log p_n} \qquad p_n \geq \frac{1}{B}n\log p_n \geq \frac{1}{B}n \log n\equiv c\,n\log n$$
\end{dem}

\section{Teoremas de Mertens}
\begin{teorema} Para todo $x\geq 1$ tenemos que
\[ \sum_{k≤x} {\log k} = x\log x -x+ \mathcal{O}(\log x) \]
\end{teorema}

\begin{dem}
Si $x\geq 1$ y $\suelo{ x } = n$
\begin{align*}
\log n! &= \sum_{k\leq x} \log k = \sum_{k \leq x} 1 \cdot \log k = \suelo{ x }\log x - \int_1^x \suelo{ t } \frac{dt}{t} = (x-\deci{x})\log x - \int_1^x (t-\deci{t})\frac{dt}{t}\\
& =
x\log x + O(\log x) - (x-1) + \int_1^x\frac{\{t\}}{t}dt =  x\log x - x  + O(\log x)
\end{align*}
Ya que 
$$
 \int_1^x\frac{\{t\}}{t}dt  \leq  \int_1^x\frac{dt}{t} = \log x 
$$

\end{dem}
\begin{lemma}
Sea $x\in\R$ y $n\in\N$, entonces
$$
\suelo{\frac{x}{n}} = \suelo{\frac{\suelo{x}}{n}}
$$
\end{lemma}
\begin{dem}
Sea $a=\suelo{x}\leq x < a+1$. Si $a=x$ no hay nada que probar. Tenemos que $\dfrac{a}{n}<\dfrac{x}{n}<\dfrac{a+1}{n}$. Por reducción al absurdo, si la tesis es falsa, $\dfrac{a}{n}<\suelo{\dfrac{x}{n}}\leq \dfrac{x}{n}$. Entonces $a<n\suelo{\dfrac{x}{n}}\leq x$. Pero $a=\suelo{x}$, por lo que no puede haber un entero que cumpla esas desigualdades.
\end{dem}
\begin{teorema}[Primer teorema de Mertens]
\[ \sum_{p≤x} \frac{\log p}{p} = \log x + \mathcal{O}(1) \]
\end{teorema}
\begin{dem}
Sea $n=\suelo{x}$. Tenemos
$$
\log n! = \sum_{k\leq x} \log k = \sum_{p\leq n}\nu_p(n!)\log p = \sum_{p\leq n}\left(\sum_{k=1}\suelo{\frac{n}{p^k}}\right)\log p
=  \sum_{p\leq n}\left(\sum_{k=1}\suelo{\frac{x}{p^k}}\right)\log p$$
Separamos la suma para $k=1$ y $k=2$, pero antes veamos que este último está acotado
\begin{align*}
\sum_{p\leq x}\left(\sum_{k=2}\suelo{\frac{x}{p^k}}\right)\log p &\leq \sum_{p\leq x}\left(\sum_{k=2}\frac{x}{p^k}\right)\log p = x\sum_{p\leq n}\log p\left(\sum_{k=2}\frac{1}{p^k}\right)\\
&= x\sum_{p\leq x} \frac{\log p }{p(p-1)} \leq x\sum_{n=2} \frac{\log n}{n(n-1)}\leq x \sum_{n=2}\frac{1}{n^{3/2}}<\infty
\end{align*}
Por tanto,
$$
\sum_{p\leq x}\left(\sum_{k=1}\suelo{\frac{x}{p^k}}\right)\log p = \sum_{p\leq x}\suelo{\frac{x}{p}}\log p+O(x)
$$
Analicemos el término que resta.
$$
\sum_{p\leq x}\deci{\frac{x}{p}}\log p \leq \sum_{p\leq x}\log p = \log \prod_{p\leq x} p \leq \log 4^{x-1} =(x-1)\log 4 = O(x)
$$
\begin{align*}
\sum_{p\leq x}\suelo{\frac{x}{p}}\log p = \sum_{p\leq x}\left(\frac{x}{p}-\deci{\frac{x}{p}}\right)\log p = \sum_{p\leq x}{\frac{x}{p}}\log p + O(x) 
\end{align*}
$$
\sum_{p\leq x}\left(\sum_{k=1}\suelo{\frac{x}{p^k}}\right)\log p = x\sum_{p\leq x}\frac{1}{p}\log p+O(x)
$$
\begin{gather*}
\sum_{n\leq x}\log n = x\log x -x+ \mathcal{O}(\log x)  = x\sum_{p\leq x}\frac{1}{p}\log p+O(x)\\
 \log x -1+ \orden{\frac{\log x}{x}}  = \sum_{p\leq x}\frac{1}{p}\log p+O(1)\\
 \sum_{p\leq x}\frac{1}{p} = \log x + \orden{1}
\end{gather*}
\end{dem}
\begin{teorema}[Mertens]
Existe una constante $C$ tal que
\[ \sum_{p≤x} \frac{1}{p} = \log \log x + C + \mathcal{O}\left(\frac{1}{\log x}\right) \]
\end{teorema}
\begin{dem}
Tenemos
$$
\sum_{p≤x} \frac{1}{p} = \sum_{p≤x} \frac{\log p}{p}\frac{1}{\log p} = \sum_{n≤x} a_n f(n)
$$
Con $f(n)=\log^{-1}(n)$ y $a_n = I_{\mathbb{P}}(n)\dfrac{\log n}{n}$. Notemos que $f(1)a_1$ está bien definido. Aplicando la Fórmula de Sumación de Abel teniendo en cuenta que $S(x)=\sum_{n\leq x}a_n = \sum_{p\leq x}\dfrac{\log}{p}$ y que, por tanto $\int_1^2S(t)f'(t)dt = 0$.
\begin{align*}
\sum_{p\leq x}\frac{1}{p}&= \sum_{p\leq x}\dfrac{\log}{p}f(x)-\int_2^x S(t)f'(t)dt = \frac{S(x)}{\log x} +\int_2^x \frac{S(t)}{t\log^2t}dt \\
&=\frac{\log x + \mathcal{O}(1)}{\log x} +\int_2^x \frac{\log t + \mathcal{O}(1)}{t\log^2t}dt = 1 + \orden{\frac{1}{\log x}}+\int_2^x\frac{dt}{t\log t}+\int_2^x\frac{O(1)}{t\log^2 t}dt\\
&=\log\log x - \log\log 2 +1 + \int_2^x\frac{U(t)}{t\log^2 t}dt+ \orden{\frac{1}{\log x}}
\end{align*}
Estudiemos 
\begin{align*}
\abs{\int_2^x\frac{U(t)}{t\log^2 t}dt}&\leq \int_2^x\frac{\abs{U(t)}}{t\log^2 t}dt \leq \int_2^x\frac{K}{t\log^2 t}dt = K\left(\frac{1}{\log 2}-\frac{1}{\log x} \right)\\
\abs{\int_x^\infty \frac{U(t)}{t\log^2 t}dt}&\leq K\int_x^{\infty}\frac{dt}{t\log^2t} = K\frac{1}{\log x}
\end{align*}
Por tanto, nos queda
\begin{align*}
\sum_{p\leq x}\frac{1}{p} &=  \log\log x - \log\log 2 +1 + \int_2^x\frac{U(t)}{t\log^2 t}dt+ \orden{\frac{1}{\log x}}\\
&=\log\log x - \log\log 2 +1 + \int_2^\infty\frac{U(t)}{t\log^2 t}dt- \int_x^\infty\frac{U(t)}{t\log^2 t}dt+\orden{\frac{1}{\log x}}\\
&=\log\log x - \log\log 2 +1 + \frac{K}{\log 2} + \orden{\frac{1}{\log x}}\\
&=\log\log x +C+ \orden{\frac{1}{\log x}}
\end{align*}
\end{dem}
\begin{teorema}[Segundo teorema de Mertens]
\[ \prod_{p≤x} \left(1-\frac{1}{p}\right)^{-1} = e^γ\log x + \mathcal{O}(1) \]
donde $γ$ denota la constante de Euler.
\end{teorema}
\begin{dem}
Si $|x|<1$ entonces
$$
\log(x-1)^{-1}=\sum_{k=1}^\infty \frac{x^k}{k}
$$
Tomando $x=1/p$ tenemos
\begin{align*}
\log \prod_{p≤x} \left(1-\frac{1}{p}\right)^{-1} &= \sum_{p\leq x}\log \left(1-\frac{1}{p}\right)^{-1} = \sum_{p\leq x}\sum_{k=1}^\infty \frac{1}{kp^k}\\
&=\sum_{p\leq x}\frac{1}{p}+\sum_{p\leq x}\sum_{k=2}^\infty \frac{1}{kp^k} \\
&=\sum_{p\leq x}\frac{1}{p}+\sum_{p}\sum_{k=2}^\infty \frac{1}{kp^k}-\sum_{p\geq x}\sum_{k=2}^\infty \frac{1}{kp^k} 
\end{align*}
Analicemos los términos
\begin{align*}
\abs{\sum_{p}\sum_{k=2}^\infty \frac{1}{kp^k}}\leq \sum_{p}\sum_{k=2}^\infty \frac{1}{p^k} = \sum_{p}\frac{1}{p(p-1)}\leq \sum_{n=1}^\infty \frac{1}{n(n-1)} = 1
\end{align*}
\begin{align*}
\abs{\sum_{p>x}\sum_{k=2}^\infty \frac{1}{kp^k}}\leq \sum_{p>x}\sum_{k=2}^\infty \frac{1}{p^k} = \sum_{p>x}\frac{1}{p(p-1)} \leq \sum_{n>x}^\infty \frac{1}{n(n-1)} \leq \frac{2}{x}
\end{align*}
Como $\sum_{p≤x} \frac{1}{p} = \log \log x + C + \mathcal{O}\left(\frac{1}{\log x}\right)$ tenemos entonces
$$
\log \prod_{p≤x} \left(1-\frac{1}{p}\right)^{-1} = \log \log x + C + \mathcal{O}\left(\frac{1}{\log x}\right) + O(1) + \orden{\frac{1}{x}} = \log \log{x} + E + \mathcal{O}\left(\frac{1}{\log x}\right) 
$$
Por tanto, exponenciando
$$
\prod_{p≤x} \left(1-\frac{1}{p}\right)^{-1} = \log{x} e^E e^{\mathcal{O}\left(\frac{1}{\log x}\right) }
$$
Estudiemos el error. Sea $U(t)$ la función del error, $|U(t)|\leq \dfrac{C}{\log x}$ $\forall x\geq x_0$. Tenemos que $\forall |x|<1/2$
\begin{align*}
e^x = \sum_{k=0}^\infty \frac{x^k}{k!} \qquad |e^x-1| = \abs{\sum_{k=1}^\infty \frac{x^k}{k!}} \leq |x|\sum_{k=1}^\infty \frac{|x|^{k-1}}{k!} \leq C'x
\end{align*}
Además $|U(t)|\leq\dfrac{C}{\log 2}$ $\forall x \geq x_1$. Sea $x_2 = \max{x_0,x_1}$, si $x\geq x_2$ 
$$
V(x)=|e^{U(x)}-1|\leq C'|U(x)|\leq \frac{CC'}{\log x} \Rightarrow V(x) = \orden{\frac{1}{\log x}}
$$
Luego
\begin{align*}
\prod_{p≤x} \left(1-\frac{1}{p}\right)^{-1} &= \log{x} e^E e^{\mathcal{O}\left(\frac{1}{\log x}\right) } = \log x e^E \left(1+V(x)\right)\\
 &= \log x e^E + e^E \log x V(x) = \log x e^E + e^E O(1)\\
 &= \log x e^E + O(1)
\end{align*}

\end{dem}

Los teoremas anteriores tienen forma más precisa:
\[ \sum_{p≤x} \frac{\log p}{p} = \log x + E + \mathcal{O}(e^{-a\sqrt{\log x}}) \]
con
\[ E = -γ-\log_{p} \frac{\log p}{p^2-p} = -γ-\sum_{m=2}^{∞} μ(m) \frac{ζ'(m)}{ζ(m)} = -1.332582275733221... \]
sus dígitos forman la sucesión \href{https://oeis.org/A083343}{A083343} en OEIS.
\[ \sum_{p≤x} \frac{1}{p} = \log \log x + M + \mathcal{O}(e^{-a\sqrt{\log x}}) \]
\[ M = \sum_{p} \left(\log \left(1-\frac{1}{p}\right)+\frac{1}{p}\right) = γ + \sum_{m=2}^{∞} \frac{\log ζ(m)}{m} = 0.261497212847643... \]
sus dígitos forman la sucesión \href{https://oeis.org/A077761}{A077761} en OEIS. 

\section{Equivalentes al teorema de los números primos}
Se denomina así al teorema que afirma
\[ \lim_{x\to+∞} \frac{π(x)\log x}{x} = 1 \]
que fue demostrado independientemente por Hadamard y de la Vallée-Poussin.

El siguiente teorema permite simplifcar la prueba del teorema de los números primos gracias a que da muchas formulaciones equivalentes.

\begin{teorema}[Chebyshev]
Existen constantes $A$ y $B$ tales que para todo $α \in (0,1)$
\[ αAx ≤ απ(x)\log x ≤ θ(x) ≤ ψ(x) ≤ π(x)\log x ≤ Bx \]
para todo $x ≥ x_0(α)$.
\end{teorema}

\begin{teorema}[Chebyshev]
\[ \liminf_{x\to∞} \frac{θ(x)}{x} = \liminf_{x\to∞} \frac{ψ(x)}{x} = \liminf_{x\to∞} \frac{π(x)\log x}{x} ≥ \log 2 \]
y
\[ \limsup_{x\to∞} \frac{θ(x)}{x} = \limsup_{x\to∞} \frac{ψ(x)}{x} = \limsup_{x\to∞} \frac{π(x)\log x}{x} ≤ \log 4 \]
\end{teorema}
Demostración en Nathanson p.271.

\section{Método de la criba}
El origen del método es la criba de Eratóstenes. La criba de Eratóstenes conduce a la siguiente fórmula.

\begin{teorema}[Fórmula de Legendre]
Para todo $x > 1$ se tiene
\[ π(x) - π(\sqrt{x}) + 1 = \sum_{n|P_x}μ(n)\suelo{\frac{x}{n}} \]
donde $P_x$ denota el producto de los números primos menores o iguales a $x$.
\end{teorema}

\begin{dem}
Sea $X=\{n≤x\}$. Para $p≤\sqrt{x}$ primo, definimos $A_p=\{n \in X, p|n\}$.
Tenemos que:
Para un $n \in X$ compuesto, como $n≤x$ entonce consideramos el menor de los primos $p$ tal que $p|n$. Debe existir $m$ con $p\cdot m = n$. Como los primos que hay en $m$ son mayores o iguales que $p$: $p^2 ≤ p\cdot m = n ≤ x$, luego $p≤\sqrt{x}$. Entonces:
\[ X \setminus \bigcup_{p≤\sqrt{x}} = \{1 \} \cup \{p : \sqrt{x} < p ≤ x\} \]
Luego
\[ \text{card}\left(X \setminus \bigcup_{p≤\sqrt{x}} A_p\right) = π(x) - π(\sqrt{x}) + 1 \]
Aplicamos el método de inclusión-exclusion y observando que:
\[ \text{card}\left(\bigcap_{j=1}^r A_{p_j}\right) =\text{card}(\{N≤x : n|N\}) = \suelo{ \frac{x}{n} }\]
donde $n = p_{j_1}\cdots p_{j_r}$, la demostración sigue sin dificultad.
\qed
\end{dem}

Esta fórmula parece poco útil a primera vista. El gran mérito de Brun es dar con técnicas que permiten hacerla útil

El problema con esta fórmula es que la diferencia $π(x)-π(\sqrt{x})$ se da en términos de una suma con demasiados sumandos, aun cuando estos sumandos se obtengan con error pequeñ al multiplicar por el número de términos se obtienen errores randes. El mérito de Brun es haber ideado un método de salvar esta dificultad.

Veremos como funciona la idea de Brun, estudiando su aplicación a la cuenta de los primos gemelos. En primer lugar introducimos la función de cuenta de estos números
\[ π_2(x) = \text{card}\{p : p \text{ y }p+2\text{ son primos y }p≤x\} \]
La idea básica del método de Brun es una modificación del método de exclusión-inclusión: si en un conjunto finito $X$ se tienen subconjuntos $(A_j)_{j=1}^n$ entonces para todo natural $h$, tal que $2≤2h≤n$
\[ \text{card}\left(X \setminus \bigcup_{j=1}^n A_j \right) ≤ \sum_{k=0}^{2h} \sum_{\text{card}(J)=k} (-1)^k \text{card}\left(\bigcap_{j\in J} A_j \right)\]

Con la ayuda de este principio se consigue probar.

Este apartado puede estudiarse en Cilleruelo \& Córdoba.

\begin{teorema}
Existe una constante $C$ tal que para $x ≥ 2$
\[ π_2(x) ≤ C \frac{x}{(\log x)^2} (\log \log x)^2 \]
\end{teorema}
Para ello cribamos el conjunto $A_x = \{(2n-1)(2n+1) : 1 ≤ n ≤ (1+x)/2\}$
por los primos impares menores que un cierto $a ≤ \sqrt{x+2}$.

\begin{coro}
Si $P_2$ es el conjunto finito o infinito de los números primos $p$ tales que $p+2$ es primo se tiene
\[ \sum_{p\in P_2} \frac{1}{p} < +∞ \]
\end{coro}

\section{El número de divisores primos de un entero}
Nos proponemos estudiar el comportamiento de la función $ω(n)$.
\begin{teorema}
Para $x ≥ 2$
\[ \sum_{n≤x} ω(n) = x\log \log x + Cx + \mathcal{O}\left(\frac{x}{\log x}\right) \]
\end{teorema}
\begin{dem}
\begin{align*}
	\sum_{n≤x} ω(n) & = \sum_{n≤x}\sum_{p|n≤x} 1 = \sum_{p≤x} \suelo{\frac{x}{p}} = \sum_{p≤x} \frac{x}{p}- \sum_{p≤x} \left\{\frac{x}{p}\right\} \\
	& = x \left(\log \log x + C + \mathcal{O}\left(\frac{1}{\log x}\right)\right) + \mathcal{O}\left(\frac{x}{\log x}\right)
\end{align*} 
\end{dem}
\begin{teorema}
Para $x ≥ 2$
\[ \sum_{n≤x} ω(n)^2 = x(\log \log x)^2 + \mathcal{O}(x \log \log x) \]
\end{teorema}
\begin{dem}
Sea $f_p(n) = 1$ si $p|n$ y $f_p(n)=0$ en caso contrario. Entonces:
\begin{align*}
	\sum_{n≤x} ω(n)^2 & = \sum_{n≤x}\left(\sum_{p|n≤x} 1\right)^2 = \sum_{n≤x}\left(\sum_{p≤x} f_p(n)\right)^2 = \sum_{n≤x} \left(\sum_{p≤x} f_p(n)^2\right) + 2 \sum_{n≤x} \sum_{p<q≤x} f_p(n)f_q(n)\\
	& = \sum_{n≤x} ω(n) + 2 \sum_{p<q≤x} \sum_{n≤x} f_p(n)f_q(n)
\end{align*} 
Aquí dejó la demostración. Al día siguiente de clase, se continuó la demostración de una forma totalmente distinta:
\begin{align*}
	\sum_{n≤x} (ω(n)-\log\log x)^2 & = \sum_{n≤x} ω(n)^2 - 2\log\log x \sum_{n≤x}ω(n) + (\log\log x)^2 \sum_{n≤x} 1\\
	& = x(\log \log x)^2+ \mathcal{O}(x\log \log x) - 2\log\log x(x\log \log x + Cx + \mathcal{O}(x/\log x))\\
	& + \suelo{ x } (\log \log x)^2 + (x-\{x\})(\log \log x)^2 =\\
	& = \mathcal{O}(x\log \log x) - 2Cx \log \log x + \mathcal{O}(x\frac{\log \log x}{\log x}) + \mathcal{O}((\log \log x)^2)
	= \mathcal{O}(x\log \log x)
\end{align*}
\qed
\end{dem}
\begin{coro}
Consideramos el conjunto $A(x)=\{n ≤ x : |ω(n)-\log \log x| > f(x)\sqrt{\log \log x}\}$ para una $f≥0$ creciente con $\lim_{x\to ∞} f(x)=∞$. Veamos que $\lim_{x\to ∞}\text{card}(A(x))/x = 0$. 
\end{coro}
\begin{dem}
Se tiene que:
\[ \text{card}(A(x))f(x)\log \log  ≤ \sum_{n≤x} (ω(n) - \log \log x)^2 ≤ Cx \log \log x \]
Entoncs:
\[ \frac{\text{card}(A(x))}{x} ≤ C \frac{x \log \log x}{f(x) \log \log x} = C \frac{x}{f(x)} \to 0\]
\qed
\end{dem}
El orden normal de $ω(n)$ es $\log \log n$ como se establece en el siguiente teorema.
\begin{teorema}[Hardy-Ramanujan]
Para cada $δ > 0$, el numero de enteros $n < x$ tales que
\[ |ω(n) - \log \log n| ≥ (\log \log x)^{1/2+δ} \]
es $ο(x)$.
\end{teorema}
La prueba puede verse en Nathanson p.238-287. También es buena la exposición de M. Kac p.71-74.

La misma afirmación vale si sustituimos $ω(n)$ por $Ω(n)$. El orden normal de $\log d(n)$ como consecuencia es $\log 2 \log \log n$.

\end{document}
